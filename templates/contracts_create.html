{% extends "base.html" %}
{% block title %}ุนูุฏ ุฌุฏูุฏ{% endblock %}
{% block content %}
<div class="card p-3">
  <div class="d-flex align-items-center justify-content-between mb-2">
    <h3 style="margin:0;">ุฅูุดุงุก ุนูุฏ ุฌุฏูุฏ</h3>
    <div class="alert alert-info" style="margin:0;">ุฑูู ุงูุนูุฏ ุณูุชูููุฏ ุชููุงุฆููุง: <strong>{{ generated_no }}</strong></div>
  </div>

  <form method="POST">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

    <!-- ูุนูููุงุช ุงูุงุฌุชูุงุน -->
    <div class="row">
      <div class="col-md-12"><h4 class="mb-2" style="color:var(--brand-navy)">ูุนูููุงุช ุงูุงุฌุชูุงุน</h4></div>
      <div class="col-md-4">
        <label class="form-label">ุงุณู ุงูููู</label>
        <input name="meeting_day_name" class="form-control" required value="{{ formvals.meeting_day_name or '' }}">
      </div>
      <div class="col-md-4">
        <label class="form-label">ุชุงุฑูุฎ ุงูุงุฌุชูุงุน (ูุฌุฑู)</label>
        <input name="meeting_date_h" class="form-control" required value="{{ formvals.meeting_date_h or '' }}">
      </div>
      <div class="col-md-4">
        <label class="form-label">ุงููุฏููุฉ</label>
        <input name="city" class="form-control" required value="{{ formvals.city or 'ุฌุฏุฉ' }}">
      </div>
    </div>

    <!-- ุจูุงูุงุช ุงูุทุฑู ุงูุซุงูู -->
    <div class="row mt-3">
      <div class="col-md-12"><h4 class="mb-2" style="color:var(--brand-navy)">ุจูุงูุงุช ุงูุทุฑู ุงูุซุงูู</h4></div>
      <div class="col-md-6">
        <label class="form-label">ุงูุงุณู</label>
        <input name="partner2_name" class="form-control" required value="{{ formvals.partner2_name or '' }}">
      </div>
      <div class="col-md-3">
        <label class="form-label">ุงููููุฉ/ุงูุณุฌู</label>
        <input name="sign2_id" class="form-control" required inputmode="numeric" placeholder="10-15 ุฑูู" value="{{ formvals.sign2_id or '' }}">
      </div>
      <div class="col-md-3">
        <label class="form-label">ุงูุฌูุงู</label>
        <input name="sign2_phone" class="form-control" required inputmode="numeric" placeholder="05XXXXXXXX" value="{{ formvals.sign2_phone or '' }}">
      </div>
      <div class="col-md-12">
        <label class="form-label">ุงูุนููุงู</label>
        <input name="client_address" class="form-control" required value="{{ formvals.client_address or '' }}">
      </div>

      <!-- ูุจูุบ ุงููุดุงุฑูุฉ (๏ทผ) -->
      <div class="col-md-6">
        <label class="form-label">ูุจูุบ ุงููุดุงุฑูุฉ</label>
        <div class="input-group">
          <input name="investment_amount" class="form-control" required inputmode="decimal" step="0.01"
                 value="{{ formvals.investment_amount or '' }}">
          <img src="{{ url_for('static', filename='img/Saudi_Riyal_Symbol.svg.png') }}" 
         alt="SAR" style="height:18px;vertical-align:middle;margin-right:4px;">
        </div>
      </div>
    </div>

    <!-- ุชูุงุตูู ูุงููุฉ -->
    <div class="row mt-3">
      <div class="col-md-12"><h4 class="mb-2" style="color:var(--brand-navy)">ุชูุงุตูู ูุงููุฉ</h4></div>

      <!-- ุฑุฃุณ ุงููุงู (๏ทผ) -->
      <div class="col-md-4">
        <label class="form-label">ุฑุฃุณ ุงููุงู (ููุฐูุฑ ูู ุงูุนูุฏ)</label>
        <div class="input-group">
          <input name="capital_amount" class="form-control" required inputmode="decimal" step="0.01"
                 value="{{ formvals.capital_amount or '' }}">
           <img src="{{ url_for('static', filename='img/Saudi_Riyal_Symbol.svg.png') }}" 
         alt="SAR" style="height:18px;vertical-align:middle;margin-right:4px;">
        </div>
      </div>

      <!-- ูุณุจุฉ ุงูุฑุจุญ (%) -->
      <div class="col-md-4">
        <label class="form-label">ูุณุจุฉ ุฑุจุญ ุงูุทุฑู ุงูุซุงูู</label>
        <div class="input-group">
          <input name="profit_percent" class="form-control" required inputmode="decimal" step="0.01"
                 value="{{ formvals.profit_percent or '30' }}">
          <span class="input-group-text">%</span>
        </div>
      </div>

      <div class="col-md-4">
        <label class="form-label">ุฏูุฑูุฉ ุฃุฑุจุงุญ (ุฃุดูุฑ)</label>
        <input name="profit_interval_months" class="form-control" required inputmode="numeric"
               value="{{ formvals.profit_interval_months or '6' }}">
      </div>
    </div>

    <!-- ููุงุนูุฏ -->
    <div class="row mt-3">
      <div class="col-md-12"><h4 class="mb-2" style="color:var(--brand-navy)">ููุงุนูุฏ</h4></div>
      <div class="col-md-4">
        <label class="form-label">ุฅุฎุทุงุฑ ุงูุณุญุจ (ุฃูุงู)</label>
        <input name="withdrawal_notice_days" class="form-control" required inputmode="numeric"
               value="{{ formvals.withdrawal_notice_days or '60' }}">
      </div>
      <div class="col-md-4">
        <label class="form-label">ุจุฏุงูุฉ ุงูุนูุฏ (ูุฌุฑู)</label>
        <input name="start_date_h" class="form-control" required value="{{ formvals.start_date_h or '' }}">
      </div>
      <div class="col-md-4">
        <label class="form-label">ููุงูุฉ ุงูุนูุฏ (ูุฌุฑู)</label>
        <input name="end_date_h" class="form-control" required value="{{ formvals.end_date_h or '' }}">
      </div>

      <!-- ุนูููุฉ ุงูุชุณููู (%) -->
      <div class="col-md-4">
        <label class="form-label">ุนูููุฉ ุงูุชุณููู</label>
        <div class="input-group">
          <input name="commission_percent" class="form-control" required inputmode="decimal" step="0.01"
                 value="{{ formvals.commission_percent or '2.5' }}">
          <span class="input-group-text">%</span>
        </div>
      </div>

      <div class="col-md-4">
        <label class="form-label">ุฅุฎุทุงุฑ ุงูุงูุณุญุงุจ (ุฃูุงู)</label>
        <input name="exit_notice_days" class="form-control" required inputmode="numeric"
               value="{{ formvals.exit_notice_days or '90' }}">
      </div>
      <div class="col-md-4">
        <label class="form-label">ุงูุงุฎุชุตุงุต ุงููุถุงุฆู</label>
        <input name="jurisdiction" class="form-control" required
               value="{{ formvals.jurisdiction or 'ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉ' }}">
      </div>
    </div>

    <div class="btn-row">
  <button class="btn btn-secondary" name="action" value="preview" type="submit">๐ ูุนุงููุฉ</button>
  <button class="btn btn-primary"   name="action" value="save"    type="submit">ุญูุธ</button>
  <button class="btn btn-outline-primary" name="action" value="save_back" type="submit">ุญูุธ ูุงูุฑุฌูุน</button>
  <button class="btn btn-success"   name="action" value="save_pdf" type="submit">ุญูุธ + PDF</button>
  <a class="btn btn-light" href="{{ url_for('contracts_list') }}">ุฅูุบุงุก</a>
</div>

  </form>

  {% if preview_content %}
    <hr>
    <h4>ูุนุงููุฉ ูุต ุงูุนูุฏ</h4>
    <pre style="white-space:pre-wrap;line-height:1.9">{{ preview_content }}</pre>
  {% endif %}
</div>

<!-- ุชุญุณูู ูุธูุฑ ุงูุฅุถุงูุงุช ูู ูุง ูุงู Bootstrap ูุญูู -->
<style>
  .input-group{display:flex; align-items:stretch; width:100%}
  .input-group>.form-control{flex:1 1 auto; width:1%;}
  .input-group-text{
    display:flex; align-items:center; padding:.375rem .6rem; border:1px solid #d1d5db;
    background:#f3f4f6; border-inline-start:0; border-radius:.375rem;
    color:#111827; font-weight:600
  }
  .input-group>.form-control:first-child{border-inline-end:0; border-top-left-radius:.375rem; border-bottom-left-radius:.375rem;}
  [dir="rtl"] .input-group>.form-control:first-child{border-inline-start:0;border-inline-end:1px solid #d1d5db}
  [dir="rtl"] .input-group-text{border-inline-start:1px solid #d1d5db;border-inline-end:0;border-top-right-radius:.375rem;border-bottom-right-radius:.375rem;border-top-left-radius:0;border-bottom-left-radius:0}
</style>
{% endblock %}
