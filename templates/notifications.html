{% extends "base.html" %}
{% block title %}الإشعارات{% endblock %}
{% block content %}
<div class="card p-3">
  <div class="d-flex align-items-center justify-content-between mb-2">
    <h3 class="m-0">الإشعارات</h3>
    <form method="post" action="{{ url_for('notifications_read_all') }}">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <button class="btn btn-sm btn-outline-primary">تعليم الكل كمقروء</button>
    </form>
  </div>

  {% if not items %}
    <div class="alert alert-info m-0">لا توجد إشعارات حالياً.</div>
  {% else %}
    <ul class="list-group">
      {% for n in items %}
        <li class="list-group-item d-flex justify-content-between align-items-start {{ '' if n.is_read else 'bg-light' }}">
          <div class="ms-2 me-auto">
            <div class="fw-bold">{{ n.title }}</div>
            {% if n.body %}<div class="small text-muted" style="white-space:pre-wrap">{{ n.body }}</div>{% endif %}
            <div class="small text-secondary mt-1">{{ n.created_at }}</div>
            {% if n.link %}
              <a class="small" href="{{ n.link }}">فتح الرابط</a>
            {% endif %}
          </div>
          <form method="post" action="{{ url_for('notifications_read', nid=n.id) }}">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            {% if not n.is_read %}
              <button class="btn btn-sm btn-primary">تعليم كمقروء</button>
            {% else %}
              <span class="badge bg-secondary">مقروء</span>
            {% endif %}
          </form>
        </li>
      {% endfor %}
    </ul>
  {% endif %}
</div>
{% endblock %}
